<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<h1>Dog Breed Statistics</h1>
<h3>What dog breed is right for you?</h3>
<hr>
<p class="wg">Working Groups</p>
<p class="slide">Slides</p>
<style>
    rect {fill: lightblue; stroke: black; }
    p.wg { position: absolute; left: 150px; top: 150px; }
    p.slide { position: absolute; left: 5px; top: 100px; }
    select { position: absolute; left: 150px; top: 190px; }
    tooltip {
        color: rgb(37, 194, 37);
        font-family: Arial, Helvetica, sans-serif;
        background: black;
        padding: 10px;
        border: 3px solid white;
        box-shadow: 0 0px 10px black;
    }
    /*div.wg { position: absolute; left: 150px; top: 175px; }*/
    div.slide { position: absolute; left: 5px; top: 135px; }
</style>
<select id="workinggroup"></select>

<div class="slide">
    <button type="button">All Working Groups</button>
    <button type="button">Herding</button>
    <button type="button">Hound</button>
    <button type="button">Non Sporting</button>
    <button type="button">Southern</button>
    <button type="button">Sporting</button>
    <button type="button">Terrier</button>
    <button type="button">Toy</button>
    <button type="button">Working</button>
</div>
<body>
<svg width=10000 height=1500 ></svg>
<script>
async function init() {
data = await d3.csv("pet_characteristics.csv");
var x = d3.scaleBand().rangeRound([0, 5000]).padding(.1).domain(data.map(function(d) { return d.BreedName; }))
var y = d3.scaleLinear().range([500,0]).domain([0, d3.max(data, function(d) { return d.MaleWtKg; })]);
var h = d3.scaleLinear().domain([0, d3.max(data, function(d) { return d.MaleWtKg; })]).range([0,500]);
var w = x.bandwidth();

for (var i = 0; i < data.length; i++) {
    console.log(data[i].BreedName)
    console.log(data[i].MaleWtKg);
}

// working group drop down
d3.select('select')
    .selectAll('groups')
    .data(d3.map(data, function(d){ return d.Group1; }).keys())
    .enter()
    .append('option')
    .text(function (d) { return d; })
    .property("selected", function(d){ return d === ''; }); //set default working group to '' (all working groups)
d3.select("#workinggroup").on("change", function() {
  applyFilter(this.value);
});
function applyFilter(value) {
    var data = csv.filter(function (d) {
        return d.Group1 === value;
    })
    d3.selectAll("rect")
      .data(data)
      .transition().duration(1000)
      .attr("x", function(d) { return x(d.BreedName); })
      .attr('y',function(d) {return y(d.MaleWtKg);})
      .attr('height',function(d,i) {return h(d.MaleWtKg);});
}

//tooltip
var tooltip = d3.select("body")
    .append("div")
        .attr("class", "tooltip")
        .style("position", "absolute")
        .style("z-index", 10)
        .style("visibility", "hidden")
        .text("Simple text");


d3.select('svg')
    .append('g')
    .attr('transform','translate(350,75)')
    .selectAll('rect')
    .data(data)
    .enter()
    .append('rect')
    .attr("x", function(d) { return x(d.BreedName); })
    .attr('y',function(d) {return y(d.MaleWtKg);})
    .attr('width', w)
    .attr('height',function(d,i) {return h(d.MaleWtKg);})
    .append('title')
    .text(d => d.BreedName + " Average Weight (kg): " + d.MaleWtKg + "\nWorking Group: " + d.Group1)
        .on("mouseover", d => {tooltip.text(d.BreedName + " Average Weight (kg): " + d.MaleWtKg + "\nWorking Group: " + d.Group1); return tooltip.style("visibility", "visible")})
        .on("mousemove", function(){return tooltip.style("top", (d3.event.pageY-10)+"px").style("left",(d3.event.pageX+10)+"px");})
        .on("mouseout", () => tooltip.style("visibility", "hidden"));

d3.select('svg')
    .append('g')
    .attr('transform','translate(350,75)')
    .call(d3.axisLeft(y));
d3.select('svg')
    .append('g')
    .attr('transform','translate(350,575)')
    .call(d3.axisBottom(x))
    .selectAll('text')
    .attr("y", 0)
    .attr("x", 9)
    .attr("dy", ".35em")
    .attr('transform','rotate(90)')
    .style("text-anchor", "start");

d3.select('svg')
    .append('text')
    .attr('transform','translate(400,75)')
    .text("All Working Groups");



}
init()

</script>
</body>
</html>

